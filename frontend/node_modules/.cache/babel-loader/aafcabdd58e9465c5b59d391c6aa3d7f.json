{"ast":null,"code":"export class Loader {\n  constructor() {\n    let apiKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.apiKey = apiKey;\n    this.options = options;\n\n    if (typeof window === 'undefined') {\n      throw new Error('google-maps is supported only in browser environment');\n    }\n  }\n\n  load() {\n    if (typeof this.api !== 'undefined') {\n      return Promise.resolve(this.api);\n    }\n\n    if (typeof this.loader !== 'undefined') {\n      return this.loader;\n    }\n\n    window[Loader.CALLBACK_NAME] = () => {\n      this.api = window['google'];\n\n      if (typeof this.resolve === 'undefined') {\n        throw new Error('Should not happen');\n      }\n\n      this.resolve(this.api);\n    };\n\n    window['gm_authFailure'] = () => {\n      if (typeof this.reject === 'undefined') {\n        throw new Error('Should not happen');\n      }\n\n      this.reject(new Error('google-maps: authentication error'));\n    };\n\n    return this.loader = new Promise((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n      const script = document.createElement('script');\n      script.src = this.createUrl();\n      script.async = true;\n\n      script.onerror = e => reject(e);\n\n      document.head.appendChild(script);\n    });\n  }\n\n  createUrl() {\n    const parameters = [`callback=${Loader.CALLBACK_NAME}`];\n\n    if (this.apiKey) {\n      parameters.push(`key=${this.apiKey}`);\n    }\n\n    for (let name in this.options) {\n      if (this.options.hasOwnProperty(name)) {\n        let value = this.options[name];\n\n        if (name === 'version') {\n          name = 'v';\n        }\n\n        if (name === 'libraries') {\n          value = value.join(',');\n        }\n\n        parameters.push(`${name}=${value}`);\n      }\n    }\n\n    return `https://maps.googleapis.com/maps/api/js?${parameters.join('&')}`;\n  }\n\n}\nLoader.CALLBACK_NAME = '_dk_google_maps_loader_cb';","map":null,"metadata":{},"sourceType":"module"}