{"ast":null,"code":"import { useState, useCallback, useRef, useEffect } from 'react';\nimport axios from 'axios';\nexport const useHttpClient = () => {\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState();\n  const activeHttpRequests = useRef([]);\n  const sendRequest = useCallback(async function (url) {\n    let method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'GET';\n    let body = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    setLoading(true);\n    const httpAbortCtrl = new AbortController();\n    activeHttpRequests.current.push(httpAbortCtrl);\n\n    try {\n      const response = await axios(url, {\n        method: method,\n        body: body,\n        signal: httpAbortCtrl.signal\n      });\n      const responseData = await response.data;\n      activeHttpRequests.current = activeHttpRequests.current.filter(reqCtrl => reqCtrl !== httpAbortCtrl);\n      setLoading(false);\n      return responseData;\n    } catch (err) {\n      setErrorMessage(err.message + ' ' + err.status || 'Something went wrong, please try again.');\n      console.log(err);\n      console.log(err.message, err.status || 'Something went wrong, please try again.');\n      setLoading(false);\n      throw err;\n    }\n  }, []);\n\n  const errorHandler = () => {\n    setErrorMessage(null);\n  };\n\n  useEffect(() => {\n    return () => {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      activeHttpRequests.current.forEach(abortCtrl => abortCtrl.abort());\n    };\n  }, []);\n  return {\n    sendRequest,\n    errorHandler,\n    loading,\n    errorMessage\n  };\n};","map":{"version":3,"names":["useState","useCallback","useRef","useEffect","axios","useHttpClient","loading","setLoading","errorMessage","setErrorMessage","activeHttpRequests","sendRequest","url","method","body","httpAbortCtrl","AbortController","current","push","response","signal","responseData","data","filter","reqCtrl","err","message","status","console","log","errorHandler","forEach","abortCtrl","abort"],"sources":["/Users/diablo/Desktop/git/MERN-project/frontend/src/shared/hook/http-hook.js"],"sourcesContent":["import { useState, useCallback, useRef, useEffect } from 'react';\nimport axios from 'axios';\n\nexport const useHttpClient = () => {\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState();\n\n  const activeHttpRequests = useRef([]);\n\n  const sendRequest = useCallback(\n    async (url, method = 'GET', body = null) => {\n      setLoading(true);\n\n      const httpAbortCtrl = new AbortController();\n      activeHttpRequests.current.push(httpAbortCtrl);\n\n      try {\n        const response = await axios(url, {\n          method: method,\n          body: body,\n          signal: httpAbortCtrl.signal,\n        });\n\n        const responseData = await response.data;\n\n        activeHttpRequests.current = activeHttpRequests.current.filter(\n          (reqCtrl) => reqCtrl !== httpAbortCtrl,\n        );\n\n        setLoading(false);\n        return responseData;\n      } catch (err) {\n        setErrorMessage(\n          err.message + ' ' + err.status ||\n            'Something went wrong, please try again.',\n        );\n        console.log(err);\n        console.log(\n          err.message,\n          err.status || 'Something went wrong, please try again.',\n        );\n        setLoading(false);\n        throw err;\n      }\n    },\n    [],\n  );\n\n  const errorHandler = () => {\n    setErrorMessage(null);\n  };\n\n  useEffect(() => {\n    return () => {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      activeHttpRequests.current.forEach((abortCtrl) => abortCtrl.abort());\n    };\n  }, []);\n\n  return { sendRequest, errorHandler, loading, errorMessage };\n};\n"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,WAAnB,EAAgCC,MAAhC,EAAwCC,SAAxC,QAAyD,OAAzD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,aAAa,GAAG,MAAM;EACjC,MAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBP,QAAQ,CAAC,KAAD,CAAtC;EACA,MAAM,CAACQ,YAAD,EAAeC,eAAf,IAAkCT,QAAQ,EAAhD;EAEA,MAAMU,kBAAkB,GAAGR,MAAM,CAAC,EAAD,CAAjC;EAEA,MAAMS,WAAW,GAAGV,WAAW,CAC7B,gBAAOW,GAAP,EAA4C;IAAA,IAAhCC,MAAgC,uEAAvB,KAAuB;IAAA,IAAhBC,IAAgB,uEAAT,IAAS;IAC1CP,UAAU,CAAC,IAAD,CAAV;IAEA,MAAMQ,aAAa,GAAG,IAAIC,eAAJ,EAAtB;IACAN,kBAAkB,CAACO,OAAnB,CAA2BC,IAA3B,CAAgCH,aAAhC;;IAEA,IAAI;MACF,MAAMI,QAAQ,GAAG,MAAMf,KAAK,CAACQ,GAAD,EAAM;QAChCC,MAAM,EAAEA,MADwB;QAEhCC,IAAI,EAAEA,IAF0B;QAGhCM,MAAM,EAAEL,aAAa,CAACK;MAHU,CAAN,CAA5B;MAMA,MAAMC,YAAY,GAAG,MAAMF,QAAQ,CAACG,IAApC;MAEAZ,kBAAkB,CAACO,OAAnB,GAA6BP,kBAAkB,CAACO,OAAnB,CAA2BM,MAA3B,CAC1BC,OAAD,IAAaA,OAAO,KAAKT,aADE,CAA7B;MAIAR,UAAU,CAAC,KAAD,CAAV;MACA,OAAOc,YAAP;IACD,CAfD,CAeE,OAAOI,GAAP,EAAY;MACZhB,eAAe,CACbgB,GAAG,CAACC,OAAJ,GAAc,GAAd,GAAoBD,GAAG,CAACE,MAAxB,IACE,yCAFW,CAAf;MAIAC,OAAO,CAACC,GAAR,CAAYJ,GAAZ;MACAG,OAAO,CAACC,GAAR,CACEJ,GAAG,CAACC,OADN,EAEED,GAAG,CAACE,MAAJ,IAAc,yCAFhB;MAIApB,UAAU,CAAC,KAAD,CAAV;MACA,MAAMkB,GAAN;IACD;EACF,CAnC4B,EAoC7B,EApC6B,CAA/B;;EAuCA,MAAMK,YAAY,GAAG,MAAM;IACzBrB,eAAe,CAAC,IAAD,CAAf;EACD,CAFD;;EAIAN,SAAS,CAAC,MAAM;IACd,OAAO,MAAM;MACX;MACAO,kBAAkB,CAACO,OAAnB,CAA2Bc,OAA3B,CAAoCC,SAAD,IAAeA,SAAS,CAACC,KAAV,EAAlD;IACD,CAHD;EAID,CALQ,EAKN,EALM,CAAT;EAOA,OAAO;IAAEtB,WAAF;IAAemB,YAAf;IAA6BxB,OAA7B;IAAsCE;EAAtC,CAAP;AACD,CAzDM"},"metadata":{},"sourceType":"module"}