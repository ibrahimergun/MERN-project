{"ast":null,"code":"import { useState, useCallback, useRef, useEffect } from 'react';\nimport axios from 'axios';\nexport const useHttpClient = () => {\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState();\n  const [resData, setResData] = useState([]);\n  const activeHttpRequests = useRef([]);\n  const sendRequest = useCallback(async function (url) {\n    let method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'GET';\n    let body = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    let headers = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    setLoading(true);\n    let responseData;\n    const httpAbortCtrl = new AbortController();\n    activeHttpRequests.current.push(httpAbortCtrl);\n    await axios(url, {\n      method: method,\n      data: body,\n      headers: headers,\n      signal: httpAbortCtrl.signal\n    }).then(successfulResponse).catch(error);\n\n    function successfulResponse(response) {\n      responseData = response.data;\n      activeHttpRequests.current = activeHttpRequests.current.filter(reqCtrl => reqCtrl !== httpAbortCtrl);\n      setLoading(false);\n      setResData(responseData.users);\n    }\n\n    function error(err) {\n      setErrorMessage(err.response.data.message + ' ' + err.response.status || 'Something went wrong, please try again.');\n      console.log(err.response.data.message, err.response.status || 'Something went wrong, please try again.');\n      setLoading(false);\n      throw err;\n    }\n\n    return responseData;\n  }, []);\n\n  const errorHandler = () => {\n    setErrorMessage(null);\n  };\n\n  useEffect(() => {\n    return () => {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      activeHttpRequests.current.forEach(abortCtrl => abortCtrl.abort());\n    };\n  }, []);\n  return {\n    sendRequest,\n    errorHandler,\n    loading,\n    errorMessage,\n    resData\n  };\n};","map":{"version":3,"names":["useState","useCallback","useRef","useEffect","axios","useHttpClient","loading","setLoading","errorMessage","setErrorMessage","resData","setResData","activeHttpRequests","sendRequest","url","method","body","headers","responseData","httpAbortCtrl","AbortController","current","push","data","signal","then","successfulResponse","catch","error","response","filter","reqCtrl","users","err","message","status","console","log","errorHandler","forEach","abortCtrl","abort"],"sources":["/Users/diablo/Desktop/git/MERN-project/frontend/src/shared/hook/http-hook.js"],"sourcesContent":["import { useState, useCallback, useRef, useEffect } from 'react';\nimport axios from 'axios';\n\nexport const useHttpClient = () => {\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState();\n  const [resData , setResData] = useState([]);\n  \n\n  const activeHttpRequests = useRef([]);\n\n  const sendRequest = useCallback(\n    async (url, method = 'GET', body = null, headers = {}) => {\n      setLoading(true);\n      let responseData;\n\n      const httpAbortCtrl = new AbortController();\n      activeHttpRequests.current.push(httpAbortCtrl);\n\n      await axios(url, {\n        method: method,\n        data: body,\n        headers: headers,\n        signal: httpAbortCtrl.signal,\n      })\n        .then(successfulResponse)\n        .catch(error);\n\n      function successfulResponse(response) {\n        responseData = response.data;\n        activeHttpRequests.current = activeHttpRequests.current.filter(\n          (reqCtrl) => reqCtrl !== httpAbortCtrl,\n        );\n        setLoading(false);\n        setResData(responseData.users);   \n      }\n      function error(err) {\n        setErrorMessage(\n          err.response.data.message + ' ' + err.response.status ||\n            'Something went wrong, please try again.',\n        );\n        console.log(\n          err.response.data.message,\n          err.response.status || 'Something went wrong, please try again.',\n        );\n        setLoading(false);\n        throw err;\n      }\n      return responseData;\n    },\n    [],\n  );\n\n  const errorHandler = () => {\n    setErrorMessage(null);\n  };\n\n  useEffect(() => {\n    return () => {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      activeHttpRequests.current.forEach((abortCtrl) => abortCtrl.abort());\n    };\n  }, []);\n\n  return { sendRequest, errorHandler, loading, errorMessage, resData };\n};\n"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,WAAnB,EAAgCC,MAAhC,EAAwCC,SAAxC,QAAyD,OAAzD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,aAAa,GAAG,MAAM;EACjC,MAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBP,QAAQ,CAAC,KAAD,CAAtC;EACA,MAAM,CAACQ,YAAD,EAAeC,eAAf,IAAkCT,QAAQ,EAAhD;EACA,MAAM,CAACU,OAAD,EAAWC,UAAX,IAAyBX,QAAQ,CAAC,EAAD,CAAvC;EAGA,MAAMY,kBAAkB,GAAGV,MAAM,CAAC,EAAD,CAAjC;EAEA,MAAMW,WAAW,GAAGZ,WAAW,CAC7B,gBAAOa,GAAP,EAA0D;IAAA,IAA9CC,MAA8C,uEAArC,KAAqC;IAAA,IAA9BC,IAA8B,uEAAvB,IAAuB;IAAA,IAAjBC,OAAiB,uEAAP,EAAO;IACxDV,UAAU,CAAC,IAAD,CAAV;IACA,IAAIW,YAAJ;IAEA,MAAMC,aAAa,GAAG,IAAIC,eAAJ,EAAtB;IACAR,kBAAkB,CAACS,OAAnB,CAA2BC,IAA3B,CAAgCH,aAAhC;IAEA,MAAMf,KAAK,CAACU,GAAD,EAAM;MACfC,MAAM,EAAEA,MADO;MAEfQ,IAAI,EAAEP,IAFS;MAGfC,OAAO,EAAEA,OAHM;MAIfO,MAAM,EAAEL,aAAa,CAACK;IAJP,CAAN,CAAL,CAMHC,IANG,CAMEC,kBANF,EAOHC,KAPG,CAOGC,KAPH,CAAN;;IASA,SAASF,kBAAT,CAA4BG,QAA5B,EAAsC;MACpCX,YAAY,GAAGW,QAAQ,CAACN,IAAxB;MACAX,kBAAkB,CAACS,OAAnB,GAA6BT,kBAAkB,CAACS,OAAnB,CAA2BS,MAA3B,CAC1BC,OAAD,IAAaA,OAAO,KAAKZ,aADE,CAA7B;MAGAZ,UAAU,CAAC,KAAD,CAAV;MACAI,UAAU,CAACO,YAAY,CAACc,KAAd,CAAV;IACD;;IACD,SAASJ,KAAT,CAAeK,GAAf,EAAoB;MAClBxB,eAAe,CACbwB,GAAG,CAACJ,QAAJ,CAAaN,IAAb,CAAkBW,OAAlB,GAA4B,GAA5B,GAAkCD,GAAG,CAACJ,QAAJ,CAAaM,MAA/C,IACE,yCAFW,CAAf;MAIAC,OAAO,CAACC,GAAR,CACEJ,GAAG,CAACJ,QAAJ,CAAaN,IAAb,CAAkBW,OADpB,EAEED,GAAG,CAACJ,QAAJ,CAAaM,MAAb,IAAuB,yCAFzB;MAIA5B,UAAU,CAAC,KAAD,CAAV;MACA,MAAM0B,GAAN;IACD;;IACD,OAAOf,YAAP;EACD,CAtC4B,EAuC7B,EAvC6B,CAA/B;;EA0CA,MAAMoB,YAAY,GAAG,MAAM;IACzB7B,eAAe,CAAC,IAAD,CAAf;EACD,CAFD;;EAIAN,SAAS,CAAC,MAAM;IACd,OAAO,MAAM;MACX;MACAS,kBAAkB,CAACS,OAAnB,CAA2BkB,OAA3B,CAAoCC,SAAD,IAAeA,SAAS,CAACC,KAAV,EAAlD;IACD,CAHD;EAID,CALQ,EAKN,EALM,CAAT;EAOA,OAAO;IAAE5B,WAAF;IAAeyB,YAAf;IAA6BhC,OAA7B;IAAsCE,YAAtC;IAAoDE;EAApD,CAAP;AACD,CA9DM"},"metadata":{},"sourceType":"module"}